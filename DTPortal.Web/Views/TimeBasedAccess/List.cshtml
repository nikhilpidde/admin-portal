@using System.Globalization
@model DTPortal.Web.ViewModel.TimeBasedAccess.TimeBasedAccessListViewModel

@{
    ViewData["Title"] = "TimeBasedAccess";
}
@{await Html.RenderPartialAsync("_AlertBox");}
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body ">
                <div class="row p-b-20">
                    <div class="col-md-6 col-sm-6 col-6">
                        <div class="btn-group">

                            <a id="addRow1" asp-action="New" class="btn btn-info"><i class="fa fa-plus"></i>Add</a>
                        </div>
                        <div class="btn-group">
                            <a class="btn btn-info" asp-action="List">
                                <i class="fa fa-refresh"></i>Refresh
                            </a>
                        </div>

                    </div>

                </div>
                <table id="userTable" class="table table-striped table-bordered table-hover table-checkable order-column full-width">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Start Time</th>
                            <th>End Time</th>
                            <th>Start Date</th>
                            <th>End Date</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.List == null || Model.List.Count() == 0)
                        {
                            <tr>
                                <td style="text-align:center" valign="top" colspan="7" class="dataTables_empty">No record found</td>
                            </tr>

                        }
                        else
                        {

                            @foreach (var item in Model.List)
                            {
                                <tr class="odd gradeX">
                                    <td>@item.Name</td>
                                    <td>@item.StartTime.Value.ToString("hh:mm tt")</td>
                                    <td>@item.EndTime.Value.ToString("hh:mm tt")</td>
                                    <td>@item.StartDate</td>
                                    <td>@(item.EndDate==null?"--:--": item.EndDate)</td>
                                    <td>@((bool)item.Deny?"Active":"Deactive")</td>
                                    <td class="valigntop">
                                        @*@if (!User.IsInRole("Roles Checker"))
                                            {*@
                                        <div class="btn-group">
                                            <button class="btn btn-xs deepPink-bgcolor no-margin" type="button" data-toggle="dropdown"
                                                    aria-expanded="false">
                                                Actions
                                                <i class="fa fa-angle-down"></i>
                                            </button>
                                            <ul class="dropdown-menu pull-left" role="menu">
                                                <li>
                                                    <a asp-action="Edit" asp-route-id="@item.Id">
                                                        <i class="icon-pencil"></i>Edit
                                                    </a>
                                                </li>
                                                <li>
                                                    <a class="js-delete" data-id="@item.Id">
                                                        <i class="fa fa-trash"></i>Delete
                                                    </a>
                                                </li>

                                            </ul>
                                        </div>
                                        @*}
                                            else
                                            {
                                                if (item.State == "UPDATED" || item.State == "BLOCKED")
                                                {

                                                    <div class="btn-group">
                                                        <button class="btn btn-xs deepPink-bgcolor no-margin" type="button" data-toggle="dropdown"
                                                                aria-expanded="false">
                                                            Actions
                                                            <i class="fa fa-angle-down"></i>
                                                        </button>
                                                        <ul class="dropdown-menu pull-left" role="menu">
                                                            <li>
                                                                <a href="@Url.Action("Edit", "RoleManagement", new { id = item.Id })">
                                                                    <i class="icon-docs"></i>View
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                }
                                            }*@
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>

            </div>
        </div>
    </div>
</div>



<style>
    .disabled {
        color: currentColor;
        cursor: not-allowed;
        opacity: 0.5;
        text-decoration: none;
    }
</style>
@section scripts
{
    <script>

    $(document).ready(function() {


            $('#administrationSidebarElement').addClass('active');
        $('#AccessFilterSidebarElement').addClass('active');
        $('#timeBasedAccessSidebarElement').addClass('active');

            $('#adminSubmenu').addClass('show');
        $('#AccessFilterSubmenu').addClass('show');

            $("li#administrationSidebarElement a:first").attr('aria-expanded', 'true');
        $("li#AccessFilterSidebarElement a:first").attr('aria-expanded', 'true');


        /*For Beadcrum Start*/
        $('#homeMenu').addClass('breadcrumb-item').append('Administration');
        $('#mainMenu').addClass('breadcrumb-item active').append('Access Filter > Time Based Access');
        $('#subMenu').removeClass('breadcrumb-item');


    //  $('#AuthenticationService').toggle();

    var table = $("#example4").DataTable({
        "bLengthChange": false,
        "bPaginate": false,
        "bInfo": false,
        "searching": true
    });

        $('#userTable').on('click', '.js-delete', function () {
            var deleteButton = $(this);
            var id = deleteButton.attr("data-id");
            swal({
                title: "Are you sure?",
                text: "Do you want to delete this record",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "Yes",
                cancelButtonText: "No",
                closeOnConfirm: false,
                closeOnCancel: true
            }, function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            type: 'POST',
                            cache: false,
                            dataType: 'json',
                            url: '@Url.Action("Delete", "TimeBasedAccess")',
                            headers: {
                                "XSRF-TOKEN": $('input[name="__RequestVerificationToken"]').val()
                            },
                            data:
                            {
                                id: id
                            },
                            beforeSend: function () {
                                $('#overlay').show();
                            },
                            complete: function () {
                                $('#overlay').hide();
                            },
                            success: function () {
                                window.location.reload();
                            },
                            error: ajaxErrorHandler
                        });
                    }
                    else {
                        return false;
                    }
            });
    });


    });

    </script>
}





@*<div class="col-sm-12 col-md-7 paginationStyle">
        <div class="dataTables_paginate paging_simple_numbers">
            <ul class="pagination">
                <li class="paginate_button page-item previous">
                    <a aria-controls="complex_header" asp-action="List"
                       asp-route-pageNumber="@(Model.Users.PageIndex - 1)"
                       class="page-link ">
                        Previous
                    </a>
                </li>

                @{
                    int count = -2;
                    while (count <= 2)
                    {
                        var index = Model.Users.PageIndex + count;

                        if (index > 0 && index < Model.Users.TotalPages)
                        {
                            if (index == Model.Users.PageIndex)
                            {
                                <li class="paginate_button page-item active">
                                    <a href="#" aria-controls="example4" asp-action="List" asp-route-pageNumber="@index"
                                       data-dt-idx="1" tabindex="0" class="page-link">@index</a>
                                </li>
                            }
                            else
                            {
                                <li class="paginate_button page-item">
                                    <a href="#" aria-controls="example4" asp-action="List" asp-route-pageNumber="@index"
                                       data-dt-idx="1" tabindex="0" class="page-link">@index</a>
                                </li>
                            }
                        }
                        count++;
                    }
                }

                <li class="paginate_button page-item next" id="complex_header_next">
                    <a aria-controls="complex_header" asp-action="List"
                       asp-route-pageNumber="@(Model.Users.PageIndex + 1)"
                       class="page-link @nextDisabled">
                        Next
                    </a>
                </li>
            </ul>
        </div>
    </div>*@
